<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Reserva a tua viagem</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Poiret+One|Raleway" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hover.css/2.1.1/css/hover-min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.0/semantic.min.css" />
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/custom.css">
    <meta charset="utf-8">
    <title>Map Distance Calculator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Poiret+One|Raleway" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hover.css/2.1.1/css/hover-min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/custom.css">

    <link rel="apple-touch-icon" sizes="57x57" href="images/favicon//apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="images/favicon//apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/favicon//apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="images/favicon//apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/favicon//apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/favicon//apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/favicon//apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/favicon//apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/favicon//apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="images/favicon//android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon//favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="images/favicon//favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon//favicon-16x16.png">
    <link rel="manifest" href="images/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <script src="js/jquery.js"></script>
    <div class="preloader"></div><!-- /.preloader -->
    <div class="page-wrapper">
    <header class="site-header header-one">
           
    
        <br />
    <nav class="navbar navbar-expand-lg navbar-light header-navigation stricky">
        <div class="container clearfix" style="width: 875px;">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="logo-box clearfix">
                <button class="menu-toggler" data-target="#main-nav-bar">
                    <span class="fa fa-bars"></span>
                </button>
            </div><!-- /.logo-box -->
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="main-navigation" id="main-nav-bar">

                <ul class="navigation-box" style="width: 590px;">
                    <li class=" current ">
                        <a href="mapa.html">Home</a>
                    <!-- /.sub-menu -->
                </li>
                <li><a href="about2.html">Sobre</a></li>
              
                <li><a href="contact2.html">Contactos</a></li>
            

    

            </div><!-- /.navbar-collapse -->

            <div class="right-side-box">
              <a buttom href="perfil.html" class="contact-btn-block"  style="text-align:center; padding-bottom: 36px;padding-right: 65px; color:#D76A29; font-size:150%;"> 
                   &nbsp;     &nbsp; Meu Perfil
                   
                    <span class="text-block">
                        
                        <span class="tag-line"></span>
                    </span>
                </a>
            </div><!-- /.right-side-box -->

             

        </div>
       

        <!-- /.container -->
    </nav>
    </header><!-- /.site-header header-one -->


         

        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"
                        aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->

        </div>
        <!-- /.container-fluid -->
        </nav>


        <div class="container-fluid raleway">
            <div class="row">
                <div class="col-md-12" style="padding: 0;">
                    <div class="map-position">
                        <div id="map"></div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <section id="locations">
                        <h3 style=" padding-top: 30px;">Indica-nos os dados da tua viagem </h3>
                        <div class="title-strips-over dark"></div>
                        <div class="form-group col-sm-12">
                            <label>
                                <i class="fa fa-play"></i> Localização de origem
                            </label>

                            <div class="ui icon big input" id="locator-input-section" style="padding-left: 5px; width: 305px;">
                                <input class="form-control" type="text" placeholder="Digita a tua localização de origem" id="start" required />
                                <i aria-hidden="true" class="dot circle outline link icon" id="locator-button"></i>
                            </div>

                        </div>
                        <div class="form-group col-sm-12">
                            <label>
                                <i class="fa fa-stop"></i> Localização destino 	&nbsp; 	&nbsp; 	&nbsp;
                            </label>
                            <div class="ui icon big input" id="locator-input-section" style="padding-left: 1px; width: 305px;">
                                <input placeholder="Digia a tua localização de destino" id="end" type="text" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <button class="btn btn" style="margin-right: 180px; background-color:#D76A29; margin-left: 15px;" id="calculate" data-scroll>
                                Reservar
                                <i class="fa fa-check"></i>
                            </button>
                        </div>

                        
                     





                    </section>



                </div>
            </div>
        </div>



        <footer class="site-footer">

            <div class="upper-footer">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-3">
                            <div class="footer-widget about-widget">
                                <div class="widget-title">
                                    <h3>Sobre</h3>
                                </div><!-- /.widget-title -->
                                <p>Garantimos sempre o melhor preço para viajares para qualquer sitio</p>
                                <div class="social-block">
                                    <a href="#"><i class="fa fa-twitter"></i></a>
                                    <a href="#"><i class="fa fa-facebook-f"></i></a>
                                    <a href="#"><i class="fa fa-youtube-play"></i></a>
                                    <a href="#"><i class="fa fa-google-plus"></i></a>
                                </div><!-- /.social-block -->
                            </div><!-- /.footer-widget about-widget -->
                        </div><!-- /.col-lg-3 -->
                        <div class="col-lg-2">
                            <div class="footer-widget">
                                <div class="widget-title">
                                    <h3>Links</h3>
                                </div><!-- /.widget-title -->
                                <ul class="link-lists">
                                    <li><a href="about.html">Sobre</a></li>
                                    <li><a href="driver.html">Condutores</a></li>
                                    <li><a href="taxi.html">Veiculos</a></li>
                                    <li><a href="contact.html">Contactos</a></li>

                                </ul>
                            </div><!-- /.footer-widget -->
                        </div><!-- /.col-lg-2 -->
                        <div class="col-lg-3">
                            <div class="footer-widget">
                                <div class="widget-title">
                                    <h3>Contacto</h3>
                                </div><!-- /.widget-title -->
                                <p>Universidade do Minho <br>Guimarães, Portugal</p>
                                <ul class="contact-infos">
                                    <li><i class="fa fa-envelope"></i> cdhelp@gmail.com</li>
                                    <li><i class="fa fa-phone-square"></i> 917805414</li>
                                </ul><!-- /.contact-infos -->
                            </div><!-- /.footer-widget -->
                        </div><!-- /.col-lg-3 -->
                        <div class="col-lg-4">
                            <div class="footer-widget">
                                <div class="widget-title">
                                    <h3>Noticias</h3>
                                </div><!-- /.widget-title -->
                                <p>Subscreva já o nosso serviço de noticias <br> para receber novidades do CheapDrive.</p>
                                <form action="#" class="subscribe-form">
                                    <input type="text" name="email" placeholder="Insira o seu Email">
                                    <button type="submit">Ir</button>
                                </form>
                            </div><!-- /.footer-widget -->
                        </div><!-- /.col-lg-4 -->
                    </div><!-- /.row -->
                </div><!-- /.container -->
            </div><!-- /.upper-footer -->
            <div class="bottom-footer">
                <div class="container">
                    <div class="inner-container">
                        <div class="left-block">
                            <a href="index.html" class="footer-logo"><img src="images/index/logo.png" alt="Awesome Image" /></a>
                        </div><!-- /.left-block -->
                        <div class="right-block">
                            <ul class="link-lists">
                                <li><a href="#">Terms of Use</a></li>
                                <li><a href="#">Privacy Policy</a></li>
                            </ul>
                        </div><!-- /.right-block -->
                    </div><!-- /.inner-container -->
                </div><!-- /.container -->
            </div><!-- /.bottom-footer -->
        </footer><!-- /.site-footer -->
    </div><!-- /.page-wrapper -->
  
    <a href="#" data-target="html" class="scroll-to-target scroll-to-top"><i class="fa fa-angle-up"></i></a>
    <!-- /.scroll-to-top -->






    

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/bootstrap-select.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/jquery.bxslider.min.js"></script>
    <script src="js/theme.js"></script>


    <!-- Compiled and minified JavaScript -->
    <script src="js/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAF6fZGfZH5FXd4wmN7T-spVRF9kI1_LGA&callback=initMap&libraries=places"
            type="text/javascript"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/smooth-scroll/12.1.5/js/smooth-scroll.min.js"></script>
    <script src="js\mapa.js"></script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-analytics.js"></script>

    <script>
     
        
var lit;
var model_info = [];
var _distance;
var _duration;
var _from;
var _to;
var _fuelConsumed;
var markers = [];
var total = 0;
var _price = 38.10;




function initMap() {
    document.getElementById("calculate").addEventListener("click", initMap);
    var locatorSection = document.getElementById("locator-input-section")
    var input = document.getElementById("start");
    var inputdest = document.getElementById("end");

    function init() {
        var locatorButton = document.getElementById("locator-button");
        locatorButton.addEventListener("click", locatorButtonPressed)

    }

    function locatorButtonPressed() {
        locatorSection.classList.add("loading")

        navigator.geolocation.getCurrentPosition(function (position) {
            getUserAddressBy(position.coords.latitude, position.coords.longitude)
        },
            function (error) {
                locatorSection.classList.remove("loading")
                alert("The Locator was denied :( Please add your address manually")
            })
    }

    function getUserAddressBy(lat, long) {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var address = JSON.parse(this.responseText)
                setAddressToInputField(address.results[0].formatted_address)
            }
        };
        xhttp.open("GET", "https://maps.googleapis.com/maps/api/geocode/json?latlng=" + lat + "," + long + "&key=AIzaSyAF6fZGfZH5FXd4wmN7T-spVRF9kI1_LGA", true);
        xhttp.send();
    }

    function setAddressToInputField(address) {

        input.value = address
        locatorSection.classList.remove("loading")
    }

    var defaultBounds = new google.maps.LatLngBounds(
        new google.maps.LatLng(39.592748, -8.296308),
    );

    var options = {
        bounds: defaultBounds
    };
    var start = new google.maps.places.Autocomplete(input, options);
    var end = new google.maps.places.Autocomplete(inputdest, options);


    init()

    var service = new google.maps.DistanceMatrixService();
    var directionsService = new google.maps.DirectionsService();

    var abeokuta = { lat: 39.592748, lng: -8.296308 };

    // Create a map and center it on Mauritius.
    var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 9,
        center: abeokuta
    });

    // Create a renderer for directions and bind it to the map.
    var directionsDisplay = new google.maps.DirectionsRenderer({
        draggable: true,
        map: map
    });

    // Listen direction change
    directionsDisplay.addListener('directions_changed', function () {
        computeTotalDistance(directionsDisplay.getDirections());
    });

    // Instantiate an info window to hold step text.
    var stepDisplay = new google.maps.InfoWindow;

    // Display the route between the initial start and end selections.
    calculateAndDisplayRoute(directionsDisplay, directionsService, markers, stepDisplay, map);
    // Listen to change events from the start and end lists.
    var onChangeHandler = function () {
        calculateAndDisplayRoute(directionsDisplay, directionsService, markers, stepDisplay, map);
    };
    document.getElementById('start').addEventListener('change', onChangeHandler);
    document.getElementById('end').addEventListener('change', onChangeHandler);

    function calculate() {


    }
    
    function computeTotalDistance(result) {
            var x = document.getElementById("precos");
            var myroute = result.routes[0];
            var duration, start, end;
            for (var i = 0; i < myroute.legs.length; i++) {
                total += myroute.legs[i].distance.value; //valor da distancia
                duration = myroute.legs[i].duration.value;
                start = myroute.legs[i].start_address;
                end = myroute.legs[i].end_address;
                document.getElementById("start").value = start;
                document.getElementById("end").value = end;
            }
            total = total / 1000;
            _distance = total;
            var t = total.toString();
            duration = duration / 60;
            var oldDateObj = new Date();
            var chegada = new Date();
            chegada.setTime(oldDateObj.getTime() + (duration * 60 * 1000));
            duration = Math.round(duration);
            localStorage.setItem("total",t);

            document.getElementById('total').innerHTML = "<h3> <i class='fa fa-play'></i> Origem: <br>" + start + "</h3> <h3><i class='fa fa-stop'></i> Destino: <br>" + end + "</h3> <h3><i class='fa fa-clipboard-check'></i> Distancia Total: <br>" + total + ' Km </h3>' + "<h3><i class='fa fa-clock'></i> Tempo estimado da viagem: <br>" + duration + " Minutos</h3>" + "<h3><i class='fa fa-clock'></i> Chegada Prevista: <br>" + chegada;
            x.style.display = "block";

        }

    function calculateAndDisplayRoute(directionsDisplay, directionsService,
        markers, stepDisplay, map) {
        // First, remove any existing markers from the map.
        for (var i = 0; i < markers.length; i++) {
            markers[i].setMap(null);
        }

        // Retrieve the start and end locations and create a DirectionsRequest using
        // DRIVING directions.
        directionsService.route({
            origin: document.getElementById('start').value,
            destination: document.getElementById('end').value,
            travelMode: 'DRIVING'
        }, function (response, status) {
            // Route the directions and pass the response to a function to create
            // markers for each step.
            if (status === 'OK') {
                document.getElementById('warnings-panel').innerHTML =
                    '<b>' + response.routes[0].warnings + '</b>';
                directionsDisplay.setDirections(response);
                // showSteps(response, markers, stepDisplay, map);
            }
        });
    }

    function showSteps(directionResult, markers, stepDisplay, map) {
        // For each step, place a marker, and add the text to the marker's infowindow.
        // Also attach the marker to an array so we can keep track of it and remove it
        // when calculating new routes.
        var myRoute = directionResult.routes[0].legs[0];
        for (var i = 0; i < myRoute.steps.length; i++) {
            var marker = markers[i] = markers[i] || new google.maps.Marker;
            marker.setMap(map);
            marker.setPosition(myRoute.steps[i].start_location);
            attachInstructionText(
                stepDisplay, marker, myRoute.steps[i].instructions, map);
        }

    }

    function attachInstructionText(stepDisplay, marker, text, map) {
        google.maps.event.addListener(marker, 'click', function () {
            // Open an info window when the marker is clicked on, containing the text
            // of the step.
            stepDisplay.setContent(text);
            stepDisplay.open(map, marker);
        });
    }



}













    </script>
</body>
</html>